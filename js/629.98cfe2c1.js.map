{"version":3,"file":"js/629.98cfe2c1.js","mappings":"0JAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACA,EAAG,SAAS,CAACE,GAAG,CAAC,MAAQJ,EAAIK,gBAAgB,CAACL,EAAIM,GAAG,eAAeJ,EAAG,SAAS,CAACE,GAAG,CAAC,MAAQJ,EAAIO,kBAAkB,CAACP,EAAIM,GAAG,SACvM,EACGE,EAAkB,G,2ECUtB,GACAC,OACA,OACAC,MAAAA,CAEA,40BACA,40BACA,00BACA,y1BACA,g1BACA,q1BACA,+0BACA,i0BACA,q1BACA,41BAKA,EACAC,QAAAA,CACAC,QAAAA,GACA,oBACA,WACA,sCACA,kCAIA,OAHA,sCACAC,IAEA,CACA,EACAR,gBAEA,2EAEA,SACA,oCACAS,EAAAA,KAAAA,CACA,gCACA,uBACA,2CACA,2BACA,2BACA,2BACA,yBACA,oCACA,+BACA,oCACA,8BAKA,+BACA,OAGA,mCAAAC,OAAAA,IACA,uBACAC,IAAAA,MAAAA,kBAAAA,EAAAA,EAAAA,UAEA,qBAAAC,SAAAA,OAAAC,KAAAA,UACA,gBAAAA,KAAAA,sEAEAC,IAAAA,OAAAA,EAAAA,YACA,EACAC,MACA,oBACAC,QAAAA,iCACAC,QAAAA,CACA,qCAyBA,OAjBAC,EAAAA,aAAAA,QAAAA,KACAC,IAEA,GADAC,QAAAA,IAAAA,IACA,UACA,8EAMA,OAFAD,EAAAA,QAAAA,SAAAA,6MAEA,KAEAE,GACA,oBAIA,CAGA,EACAnB,kBAKA,ICpH6P,I,UCOzPoB,GAAY,OACd,EACA5B,EACAS,GACA,EACA,KACA,KACA,MAIF,EAAemB,EAAiB,O","sources":["webpack://vue-ego/./src/views/Home/index.vue","webpack://vue-ego/src/views/Home/index.vue","webpack://vue-ego/./src/views/Home/index.vue?dc86","webpack://vue-ego/./src/views/Home/index.vue?4a09"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('button',{on:{\"click\":_vm.exportToExcel}},[_vm._v(\"导出为 Excel\")]),_c('button',{on:{\"click\":_vm.sendPostRequest}},[_vm._v(\"请求\")])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div>\n        <button @click=\"exportToExcel\">导出为 Excel</button>\n        <button @click=\"sendPostRequest\">请求</button>\n    </div>\n\n</template>\n\n<script>\nimport FileSaver from 'file-saver';\nimport XLSX from 'xlsx';\nimport axios from 'axios';\nexport default {\n    data() {\n        return {\n            data1: [\n\n                { \"salesno\": null, \"salesname\": null, \"name\": null, \"address\": \"广东省广州市天河区柯木塱背坪窑屋地西街一巷11号\", \"sex\": \"男\", \"birthDate\": \"1995-02-03\", \"idCode\": \"445224199502036919\", \"mobile\": \"18826248814\", \"vipFlag\": \"0\", \"prem\": 4692, \"cntrNum\": \"3\", \"njFlag\": \"0\", \"zgFlag\": null, \"jkxFlag\": \"0\", \"maxInForceDate\": null, \"custNo\": \"2019440100500990318\", \"sourceType\": \"0\", \"remark\": null, \"orphanFlag\": null, \"directFlag\": null, \"customerName\": \"陈宏光\", \"region\": null, \"id\": \"8499309\", \"salesCode\": null, \"allocName\": null, \"allocBy\": \"44010000900989\", \"allocByName\": null, \"historyAllocNum\": null, \"currentAllocName\": null, \"currentAllocSeries\": null, \"callCustomerNum\": null, \"lastServiceTime\": \"2024-07-11 17:55\", \"allocTime\": \"2024-07-11\", \"lastServiceId\": \"1811338605954011138\", \"lastServiceTag\": \"客情维系\", \"lastServiceEndTag\": \"空号/错号/无号\", \"bdzySalesCode\": null, \"sourceTypeName\": \"孤单客户\", \"lastCallTime\": null, \"totalCallDuration\": null, \"batchCode\": null, \"repoCode\": null, \"zcManager\": null, \"expireMeetFlag\": \"0\", \"expireMioFlag\": \"0\" },\n                { \"salesno\": null, \"salesname\": null, \"name\": null, \"address\": \"广州市天河区沐陂大街永泰东12号\", \"sex\": \"女\", \"birthDate\": \"1972-04-20\", \"idCode\": \"512922197204205608\", \"mobile\": \"13539402038\", \"vipFlag\": \"0\", \"prem\": 1460, \"cntrNum\": \"1\", \"njFlag\": \"0\", \"zgFlag\": null, \"jkxFlag\": \"0\", \"maxInForceDate\": \"2005-10-19 00:00\", \"custNo\": \"2005440166500001367\", \"sourceType\": \"0\", \"remark\": null, \"orphanFlag\": null, \"directFlag\": null, \"customerName\": \"李玉香\", \"region\": null, \"id\": \"8499350\", \"salesCode\": null, \"allocName\": null, \"allocBy\": \"44010000900989\", \"allocByName\": null, \"historyAllocNum\": null, \"currentAllocName\": null, \"currentAllocSeries\": null, \"callCustomerNum\": null, \"lastServiceTime\": \"2024-07-12 17:42\", \"allocTime\": \"2024-07-11\", \"lastServiceId\": \"1811697571593961474\", \"lastServiceTag\": \"面见\", \"lastServiceEndTag\": \"同意面见\", \"bdzySalesCode\": null, \"sourceTypeName\": \"孤单客户\", \"lastCallTime\": null, \"totalCallDuration\": null, \"batchCode\": null, \"repoCode\": null, \"zcManager\": null, \"expireMeetFlag\": \"0\", \"expireMioFlag\": \"0\" },\n                { \"salesno\": null, \"salesname\": null, \"name\": null, \"address\": \"广州市天河区沐陂大街永泰东12号\", \"sex\": \"女\", \"birthDate\": \"1972-04-20\", \"idCode\": \"512922197204205608\", \"mobile\": \"13539402038\", \"vipFlag\": \"0\", \"prem\": 39, \"cntrNum\": \"1\", \"njFlag\": \"0\", \"zgFlag\": null, \"jkxFlag\": \"0\", \"maxInForceDate\": \"2005-10-19 00:00\", \"custNo\": \"2005440166500001367\", \"sourceType\": \"0\", \"remark\": null, \"orphanFlag\": null, \"directFlag\": null, \"customerName\": \"李玉香\", \"region\": null, \"id\": \"8499350\", \"salesCode\": null, \"allocName\": null, \"allocBy\": \"44010000900989\", \"allocByName\": null, \"historyAllocNum\": null, \"currentAllocName\": null, \"currentAllocSeries\": null, \"callCustomerNum\": null, \"lastServiceTime\": \"2024-07-12 17:42\", \"allocTime\": \"2024-07-11\", \"lastServiceId\": \"1811697571593961474\", \"lastServiceTag\": \"面见\", \"lastServiceEndTag\": \"同意面见\", \"bdzySalesCode\": null, \"sourceTypeName\": \"孤单客户\", \"lastCallTime\": null, \"totalCallDuration\": null, \"batchCode\": null, \"repoCode\": null, \"zcManager\": null, \"expireMeetFlag\": \"0\", \"expireMioFlag\": \"0\" },\n                { \"salesno\": null, \"salesname\": null, \"name\": null, \"address\": \"广州市天河区中山大道华景新城华门阁D栋704房\", \"sex\": \"女\", \"birthDate\": \"1972-11-14\", \"idCode\": \"440524197211142669\", \"mobile\": \"13539452059\", \"vipFlag\": \"0\", \"prem\": 1500, \"cntrNum\": \"1\", \"njFlag\": \"0\", \"zgFlag\": null, \"jkxFlag\": \"0\", \"maxInForceDate\": \"2007-08-08 00:00\", \"custNo\": \"2007440172500052122\", \"sourceType\": \"0\", \"remark\": null, \"orphanFlag\": null, \"directFlag\": null, \"customerName\": \"张琼华\", \"region\": null, \"id\": \"8499352\", \"salesCode\": null, \"allocName\": null, \"allocBy\": \"44010000900989\", \"allocByName\": null, \"historyAllocNum\": null, \"currentAllocName\": null, \"currentAllocSeries\": null, \"callCustomerNum\": null, \"lastServiceTime\": \"2024-07-15 15:02\", \"allocTime\": \"2024-07-11\", \"lastServiceId\": \"1812744622878941185\", \"lastServiceTag\": \"客情维系\", \"lastServiceEndTag\": \"空号/错号/无号\", \"bdzySalesCode\": null, \"sourceTypeName\": \"孤单客户\", \"lastCallTime\": null, \"totalCallDuration\": null, \"batchCode\": null, \"repoCode\": null, \"zcManager\": null, \"expireMeetFlag\": \"0\", \"expireMioFlag\": \"0\" },\n                { \"salesno\": null, \"salesname\": null, \"name\": null, \"address\": \"广东省广州市天河区新塘街沐陂路25号\", \"sex\": \"女\", \"birthDate\": \"1971-12-04\", \"idCode\": \"430422197112042128\", \"mobile\": \"13148954689\", \"vipFlag\": \"0\", \"prem\": 2430, \"cntrNum\": \"1\", \"njFlag\": \"0\", \"zgFlag\": null, \"jkxFlag\": \"0\", \"maxInForceDate\": \"2009-08-13 00:00\", \"custNo\": \"2001440130000031643\", \"sourceType\": \"0\", \"remark\": null, \"orphanFlag\": null, \"directFlag\": null, \"customerName\": \"王雪梅\", \"region\": null, \"id\": \"8499363\", \"salesCode\": null, \"allocName\": null, \"allocBy\": \"44010000900989\", \"allocByName\": null, \"historyAllocNum\": null, \"currentAllocName\": null, \"currentAllocSeries\": null, \"callCustomerNum\": null, \"lastServiceTime\": \"2024-07-15 15:58\", \"allocTime\": \"2024-07-11\", \"lastServiceId\": \"1812758651844354049\", \"lastServiceTag\": \"客情维系\", \"lastServiceEndTag\": \"无人接听\", \"bdzySalesCode\": null, \"sourceTypeName\": \"孤单客户\", \"lastCallTime\": null, \"totalCallDuration\": null, \"batchCode\": null, \"repoCode\": null, \"zcManager\": null, \"expireMeetFlag\": \"0\", \"expireMioFlag\": \"0\" },\n                { \"salesno\": null, \"salesname\": null, \"name\": null, \"address\": \"广州市海珠区江燕路江燕南二街24号803房\", \"sex\": \"女\", \"birthDate\": \"1985-07-18\", \"idCode\": \"440104198507180426\", \"mobile\": \"13794388610\", \"vipFlag\": \"1\", \"prem\": 4800, \"cntrNum\": \"1\", \"njFlag\": \"0\", \"zgFlag\": null, \"jkxFlag\": \"1\", \"maxInForceDate\": \"2013-06-02 00:00\", \"custNo\": \"2013440172500008485\", \"sourceType\": \"0\", \"remark\": null, \"orphanFlag\": null, \"directFlag\": null, \"customerName\": \"黄淑仪\", \"region\": null, \"id\": \"8499366\", \"salesCode\": null, \"allocName\": null, \"allocBy\": \"44010000900989\", \"allocByName\": null, \"historyAllocNum\": null, \"currentAllocName\": null, \"currentAllocSeries\": null, \"callCustomerNum\": null, \"lastServiceTime\": \"2024-07-25 15:33\", \"allocTime\": \"2024-07-11\", \"lastServiceId\": \"1816376292010405890\", \"lastServiceTag\": \"客情维系\", \"lastServiceEndTag\": \"暂不需要服务\", \"bdzySalesCode\": null, \"sourceTypeName\": \"孤单客户\", \"lastCallTime\": null, \"totalCallDuration\": null, \"batchCode\": null, \"repoCode\": null, \"zcManager\": null, \"expireMeetFlag\": \"0\", \"expireMioFlag\": \"0\" },\n                { \"salesno\": null, \"salesname\": null, \"name\": null, \"address\": \"广州市天河区体育西路天河北街1号603\", \"sex\": \"女\", \"birthDate\": \"1968-02-02\", \"idCode\": \"440104196802020047\", \"mobile\": \"13501510292\", \"vipFlag\": \"0\", \"prem\": 340, \"cntrNum\": \"1\", \"njFlag\": \"0\", \"zgFlag\": null, \"jkxFlag\": \"0\", \"maxInForceDate\": \"1997-11-25 00:00\", \"custNo\": \"1999442803800976487\", \"sourceType\": \"0\", \"remark\": null, \"orphanFlag\": null, \"directFlag\": null, \"customerName\": \"徐春\", \"region\": null, \"id\": \"8499383\", \"salesCode\": null, \"allocName\": null, \"allocBy\": \"44010000900989\", \"allocByName\": null, \"historyAllocNum\": null, \"currentAllocName\": null, \"currentAllocSeries\": null, \"callCustomerNum\": null, \"lastServiceTime\": \"2024-07-15 17:12\", \"allocTime\": \"2024-07-11\", \"lastServiceId\": \"1812777273060560898\", \"lastServiceTag\": \"客情维系\", \"lastServiceEndTag\": \"无人接听\", \"bdzySalesCode\": null, \"sourceTypeName\": \"孤单客户\", \"lastCallTime\": null, \"totalCallDuration\": null, \"batchCode\": null, \"repoCode\": null, \"zcManager\": null, \"expireMeetFlag\": \"0\", \"expireMioFlag\": \"0\" },\n                { \"salesno\": null, \"salesname\": null, \"name\": null, \"address\": \"广州市天河北路595号2802\", \"sex\": \"女\", \"birthDate\": \"1963-04-30\", \"idCode\": \"440102196304306541\", \"mobile\": \"13650784150\", \"vipFlag\": \"1\", \"prem\": 9370, \"cntrNum\": \"3\", \"njFlag\": \"0\", \"zgFlag\": null, \"jkxFlag\": \"0\", \"maxInForceDate\": null, \"custNo\": \"2000440163000066606\", \"sourceType\": \"0\", \"remark\": null, \"orphanFlag\": null, \"directFlag\": null, \"customerName\": \"陈丽芬\", \"region\": null, \"id\": \"8499399\", \"salesCode\": null, \"allocName\": null, \"allocBy\": \"44010000900989\", \"allocByName\": null, \"historyAllocNum\": null, \"currentAllocName\": null, \"currentAllocSeries\": null, \"callCustomerNum\": null, \"lastServiceTime\": \"2024-07-25 14:28\", \"allocTime\": \"2024-07-11\", \"lastServiceId\": \"1816359941313179649\", \"lastServiceTag\": \"客情维系\", \"lastServiceEndTag\": \"暂不需要服务\", \"bdzySalesCode\": null, \"sourceTypeName\": \"孤单客户\", \"lastCallTime\": null, \"totalCallDuration\": null, \"batchCode\": null, \"repoCode\": null, \"zcManager\": null, \"expireMeetFlag\": \"0\", \"expireMioFlag\": \"0\" },\n                { \"salesno\": null, \"salesname\": null, \"name\": null, \"address\": \"广东省广州市天河区龙口东路36号4栋102房\", \"sex\": \"女\", \"birthDate\": \"1964-09-06\", \"idCode\": \"44010619640906402X\", \"mobile\": \"13924180288\", \"vipFlag\": \"0\", \"prem\": 680, \"cntrNum\": \"1\", \"njFlag\": \"0\", \"zgFlag\": null, \"jkxFlag\": \"0\", \"maxInForceDate\": \"1998-12-11 00:00\", \"custNo\": \"1999442803802618675\", \"sourceType\": \"0\", \"remark\": null, \"orphanFlag\": null, \"directFlag\": null, \"customerName\": \"王雪梅\", \"region\": null, \"id\": \"8499595\", \"salesCode\": null, \"allocName\": null, \"allocBy\": \"44010000900989\", \"allocByName\": null, \"historyAllocNum\": null, \"currentAllocName\": null, \"currentAllocSeries\": null, \"callCustomerNum\": null, \"lastServiceTime\": \"2024-07-25 14:27\", \"allocTime\": \"2024-07-11\", \"lastServiceId\": \"1816359482410184705\", \"lastServiceTag\": \"客情维系\", \"lastServiceEndTag\": \"暂不需要服务\", \"bdzySalesCode\": null, \"sourceTypeName\": \"孤单客户\", \"lastCallTime\": null, \"totalCallDuration\": null, \"batchCode\": null, \"repoCode\": null, \"zcManager\": null, \"expireMeetFlag\": \"0\", \"expireMioFlag\": \"0\" },\n                { \"salesno\": null, \"salesname\": null, \"name\": null, \"address\": \"广东广州海珠江南大道中路益丰北街27号1301房\", \"sex\": \"女\", \"birthDate\": \"1973-09-19\", \"idCode\": \"44010319730919392X\", \"mobile\": \"13503030350\", \"vipFlag\": \"0\", \"prem\": 1184, \"cntrNum\": \"1\", \"njFlag\": \"0\", \"zgFlag\": null, \"jkxFlag\": \"0\", \"maxInForceDate\": \"1997-12-01 00:00\", \"custNo\": \"2000440153000048333\", \"sourceType\": \"0\", \"remark\": null, \"orphanFlag\": null, \"directFlag\": null, \"customerName\": \"罗健仪\", \"region\": null, \"id\": \"8499629\", \"salesCode\": null, \"allocName\": null, \"allocBy\": \"44010000900989\", \"allocByName\": null, \"historyAllocNum\": null, \"currentAllocName\": null, \"currentAllocSeries\": null, \"callCustomerNum\": null, \"lastServiceTime\": \"2024-07-25 14:47\", \"allocTime\": \"2024-07-11\", \"lastServiceId\": \"1816364648375037953\", \"lastServiceTag\": \"客情维系\", \"lastServiceEndTag\": \"客户在忙，晚点联系\", \"bdzySalesCode\": null, \"sourceTypeName\": \"孤单客户\", \"lastCallTime\": null, \"totalCallDuration\": null, \"batchCode\": null, \"repoCode\": null, \"zcManager\": null, \"expireMeetFlag\": \"0\", \"expireMioFlag\": \"0\" }\n\n            ]\n\n        }\n    },\n    methods: {\n        dayberi(birthDate) {\n            const birth = new Date(birthDate);\n            const current = new Date();\n            let age = current.getFullYear() - birth.getFullYear();\n            const monthDiff = current.getMonth() - birth.getMonth();\n            if (monthDiff < 0 || (monthDiff === 0 && current.getDate() < birth.getDate())) {\n                age--;\n            }\n            return age;\n        },\n        exportToExcel() {\n            // 自定义表头\n            const headers = ['姓名', '性別', '年龄', '地址', '客户号', '星级', '总保费', '客户类型', '分配时间', '投保时间', '手机号码'];\n            // 数据列表\n            let newData = []\n            for (let i = 0; this.data1.length > i; i++) {\n                newData.push({\n                    '姓名': this.data1[i].customerName,\n                    '性別': this.data1[i].sex,\n                    '年龄': this.dayberi(this.data1[i].birthDate),\n                    '地址': this.data1[i].address,\n                    \"客户号\": this.data1[i].custNo,\n                    '星级': this.data1[i].vipFlag,\n                    '总保费': this.data1[i].prem,\n                    '客户类型': this.data1[i].sourceTypeName,\n                    '分配时间': this.data1[i].allocTime,\n                    '投保时间': this.data1[i].maxInForceDate,\n                    '手机号码': this.data1[i].mobile\n\n\n                })\n            }\n            if (this.data1.length != newData.length) {\n                return\n            }\n\n            const worksheet = XLSX.utils.json_to_sheet(newData, { header: headers });\n            const workbook = XLSX.utils.book_new();\n            XLSX.utils.book_append_sheet(workbook, worksheet, 'Sheet1');\n\n            const excelBuffer = XLSX.write(workbook, { bookType: 'xlsx', type: 'array' });\n            const dataBlob = new Blob([excelBuffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });\n\n            FileSaver.saveAs(dataBlob, '表格信息.xlsx');\n        },\n        hes() {\n            const service = axios.create({\n                baseURL: ' https://gdwx2.e-chinalife.com',\n                headers: {\n                    'Content-Type': 'application/json',\n\n                },\n            });\n\n\n\n            // 请求拦截器\n            service.interceptors.request.use(\n                (config) => {\n                    console.log(config)\n                    if (!config.headers) {\n                        throw new Error(`Expected 'config' and 'config.headers' not to be undefined`);\n                    }\n\n                    // 授权token认证    设置token\n                    config.headers['token'] = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJzdWIiOiI0NDAxMDAwMDI2ODkxNCIsImlhdCI6MTcyMDc5NTU1NSwiZXhwIjoxNzIxNDAwMzU1fQ.d5ecisbiOc-ipmwNzbBuCrwZvcxSqD2qWMxVlN_vz_6psh-B2eKySRCansPvRncfhU7O17ENx9huQD4T95U5jQ';\n\n                    return config;\n                },\n                (error) => {\n                    return Promise.reject(error);\n                },\n            );\n\n            return service;\n\n\n        },\n        sendPostRequest() {\n\n\n\n\n        }\n    }\n}\n</script>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=ad66ef64\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","on","exportToExcel","_v","sendPostRequest","staticRenderFns","data","data1","methods","dayberi","age","newData","header","XLSX","bookType","type","FileSaver","hes","baseURL","headers","service","config","console","error","component"],"sourceRoot":""}