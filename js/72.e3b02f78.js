"use strict";(self["webpackChunkvue_ego"]=self["webpackChunkvue_ego"]||[]).push([[72],{5072:function(t,e,a){a.r(e),a.d(e,{default:function(){return h}});var s=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"modelclass"},[e("div",[e("div",[t._v("Token："),e("input",{directives:[{name:"model",rawName:"v-model",value:t.headers.Token,expression:"headers.Token"}],staticClass:"inputclass",attrs:{type:"text"},domProps:{value:t.headers.Token},on:{input:function(e){e.target.composing||t.$set(t.headers,"Token",e.target.value)}}})]),e("div",[t._v("条数："),e("input",{directives:[{name:"model",rawName:"v-model",value:t.querdata.limit,expression:"querdata.limit"}],staticClass:"inputclass",attrs:{type:"text"},domProps:{value:t.querdata.limit},on:{input:function(e){e.target.composing||t.$set(t.querdata,"limit",e.target.value)}}})])]),e("button",{staticClass:"buttonvq",on:{click:t.makeRequest}},[t._v("发送请求")]),t._v(" 总数据："+t._s(t.dataD.result.totalCount)+" 本次数据："+t._s(t.dataD.result.list.length)+" "),e("button",{staticClass:"buttonvq",on:{click:t.exportToExcel}},[t._v("生成exlsx")])]),e("div",{staticStyle:{"margin-left":"20px"}},[t._v(" 数据列表")]),e("div",{staticClass:"itemclass"},[e("div",t._l(t.dataD.result.list,(function(a,s){return e("div",{key:s,staticClass:"margintop"},[e("div",[t._v(" 姓名："+t._s(a.customerName)),e("div",[t._v(" 性別："+t._s(a.sex))]),e("div",[t._v(" 年龄："+t._s(a.dayberi))])]),e("div",[t._v(" 地址："+t._s(a.address))]),e("div",[t._v(" 客户号："+t._s(a.custNo)+" "),e("div",[t._v(" 星级："+t._s(a.vipFlag))]),e("div",[t._v(" 总保费："+t._s(a.prem))])]),e("div",[t._v(" 保单名称："+t._s(a.customerName)),e("div",[t._v(" 客户类型："+t._s(a.sourceTypeName))])]),e("div",[t._v(" 分配时间："+t._s(a.allocTime)),e("div",[t._v(" 投保时间："+t._s(a.maxInForceDate))]),e("div",[t._v(" 手机号码："+t._s(a.mobile))])])])})),0),e("div",{staticClass:"jsonclass"},t._l(t.dataD.result.list,(function(a,s){return e("div",{key:s,staticClass:"margintop"},[t._v(" "+t._s(a)+", ")])})),0)])])},i=[],l=(a(7658),a(8428)),o=a.n(l),r=a(6010),n=a.n(r),u=a(6091),d=a.n(u),c={data(){return{url:"/api/gdsfp-web-uat/app/listSzCustomersPage",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json",Token:"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJzdWIiOiI0NDAxMDAwMDI2OTM5MCIsImlhdCI6MTcyMjg2NzA2NywiZXhwIjoxNzIzNDcxODY3fQ.RvMJBMoojqx25kgyZn43fBZTat9VVnOhMmuFP9dppJ-f9yVhENXKD5h6SCVT-QFyWHH9VKuhXQH_HUlISJ_5kw"},querdata:{fuzzyQueryInput:"",hasVisitFlag:-1,limit:100,maxAge:"",maxPremium:"",minAge:"",minPremium:"",month:"",page:1,sex:"",sourceType:"0",vipFlag:""},tooal:0,hasMoreData:!0,dataD:{result:{totalCount:0,list:[]}},isend:!1}},methods:{async makeRequest(){let t=this;await o().post(t.url,t.querdata,{headers:t.headers}).then((e=>{t.dataD.result.totalCount=e.data.result.totalCount,t.dataD.result.list=e.data.result.list,t.hasMoreData=e.data.result.list.length===t.querdata.limit})).catch((t=>{console.log(t,12345)}))},async salesq(t){let e=this,a=await o().get("/api/gdsfp-web-uat/app/szCustomerInfoNew?idCode="+t+"&sourceType=0",{headers:e.headers});return a},async automationRequests(){this.isend=!0;let t=this;for(const a of t.dataD.result.list)try{let e=await t.salesq(a.idCode);const s=await o().get("/api/gdsfp-web-uat/app/queryCntrList?idCode="+a.idCode+"&salesNo="+e.data.result.salesno,{headers:t.headers});s.data.result;console.log(s.data,"kjj"),0!=s.data.result.length&&(a.allocName=s.data.result[0].list[0].polCode+" +¥"+s.data.result[0].list[0].premium),t.tooal=Number(t.tooal)+1}catch(e){console.error(`请求 ID 为 ${a.id} 时出错: `,e)}t.tooal==t.dataD.result.totalCount&&alert("生成保单的数据成功")},dayberi(t){const e=new Date(t),a=new Date;let s=a.getFullYear()-e.getFullYear();const i=a.getMonth()-e.getMonth();return(i<0||0===i&&a.getDate()<e.getDate())&&s--,s},exportToExcel(){const t=["姓名","性別","年龄","地址","客户号","星级","总保费","客户类型","分配时间","投保时间","手机号码"];let e=[],a=this.dataD.result.list;for(let r=0;a.length>r;r++)e.push({"姓名":a[r].customerName,"性別":a[r].sex,"年龄":this.dayberi(a[r].birthDate),"地址":a[r].address,"客户号":a[r].custNo,"星级":a[r].vipFlag,"总保费":a[r].prem,"客户类型":a[r].sourceTypeName,"分配时间":a[r].allocTime,"投保时间":a[r].maxInForceDate,"手机号码":a[r].mobile});if(a.length!=e.length)return;const s=d().utils.json_to_sheet(e,{header:t}),i=d().utils.book_new();d().utils.book_append_sheet(i,s,"Sheet1");const l=d().write(i,{bookType:"xlsx",type:"array"}),o=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});n().saveAs(o,"表格信息.xlsx")}}},p=c,m=a(1001),v=(0,m.Z)(p,s,i,!1,null,null,null),h=v.exports}}]);
//# sourceMappingURL=72.e3b02f78.js.map